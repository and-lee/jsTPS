<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>jsTPS Unit Tester</title>

    <script src="./src/jsTPS.js"></script>
    <script src="./src/jsTPS_Transaction.js"></script>
    <script src="./test/Num.js"></script>
    <script src="./test/AddToNum_Transaction.js"></script>
    <script src="./test/OrMask_Transaction.js"></script>
    <script src="./test/AndMask_Transaction.js"></script>

    <script>      
      let tps = new jsTPS();
      let num = new Num();

      function add() {
        let addAmount = parseFloat(document.getElementById("addAmount").value);
        let transaction = new AddToNum_Transaction(num, addAmount);
        tps.addTransaction(transaction);

        document.getElementById("value").innerHTML = num.getNum();
        document.getElementById("currTPS").innerHTML =tps.toString();
        console.log(transaction);
        console.log(tps);
      }

      function undo() {
        tps.undoTransaction()

        document.getElementById("value").innerHTML = num.getNum();
        document.getElementById("currTPS").innerHTML =tps.toString();
        console.log(tps);
      }

      function redo() {
        tps.doTransaction();

        document.getElementById("value").innerHTML = num.getNum();
        document.getElementById("currTPS").innerHTML =tps.toString();
        console.log(tps);
      }

      function clearAll() {
        tps.clearAllTransactions();

        document.getElementById("value").innerHTML = num.getNum();
        document.getElementById("currTPS").innerHTML =tps.toString();
        console.log(tps);
      }

      function reset() { // clear and reset amount
        tps.clearAllTransactions(); //clear all transactions from the stack
        num.setNum(0); // reset value

        document.getElementById("value").innerHTML = num.getNum();
        document.getElementById("currTPS").innerHTML =tps.toString();
        console.log(tps);
      }
    </script>

  </head>
  
  <body style="font-family:Arial, Helvetica, sans-serif;">
    <div style="float: left; width:50%">
      <h2>DEMO</h2>
      <div style="font-size: 42px">num is <span id = "value">0</span></div>  
      
      <h2>ENTER A SELECTION</h2>
      <div style="font-size: 24px;">
        Enter an amount to add: 
        <input type = "number" id="addAmount" style="font-size: 24px;" autocomplete='off'>
      </div>
      <button onclick="add()" style="font-size: 24px;">Add a Transaction</button>
      <p><button onclick="undo()" style="font-size: 24px;">Undo a Transaction</button></p>
      <p><button onclick="redo()" style="font-size: 24px;">Redo a Transaction</button></p>
      <p><button onclick="clearAll()" style="font-size: 24px;">Clear All Transactions</button></p>
      <p><button onclick="reset()" style="font-size: 24px;">Reset Num and Transactions</button></p>

      <br>
      <h2>CURRENT jsTPS:</h2>
      <div id="currTPS"></div>
    </div>

    <div style="float: right; width: 45%">
      <h2>UNIT TESTS</h2>
      <p id="unitTest"></p>
    </div>

    <script>
      let tps2 = new jsTPS();
      let num2 = new Num();
      let unitTests = document.getElementById("unitTest");

      let testAdd0 = document.createElement("p");
      testAdd0.innerHTML = "<strong>testAdd</strong>"
        +"<br/>Num == 0 : " + (num2.getNum()==0);
      unitTests.innerHTML += testAdd0.innerHTML+"<br/>";

      // ADD 5 TRANSACTION
      let testAdd1 = document.createElement("p");
      tps2.addTransaction(new AddToNum_Transaction(num2,5));
      testAdd1.innerHTML = ("<br>ADD 5 TRANSACTION"
        +"<br/>Num == 5 : " + (num2.getNum()==5)
        +"<br/>jsTPS size == 1 : " + (tps2.getSize()==1)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 1 : " + (tps2.getUndoSize()==1));
      unitTests.innerHTML += testAdd1.innerHTML+"<br/>";
      // ADD 10 TRANSACTION
      let testAdd2 = document.createElement("p");
      tps2.addTransaction(new AddToNum_Transaction(num2,10));
      testAdd2.innerHTML = ("<br/>ADD 10 TRANSACTION"
        +"<br/>Num == 15 : " + (num2.getNum()==15)
        +"<br/>jsTPS size == 2 : " + (tps2.getSize()==2)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 2 : " + (tps2.getUndoSize()==2));
      unitTests.innerHTML += testAdd2.innerHTML+"<br/>";
      // ADD 20 TRANSACTION
      let testAdd3 = document.createElement("p");
      tps2.addTransaction(new AddToNum_Transaction(num2,20));
      testAdd3.innerHTML = ("<br/>ADD 20 TRANSACTION"
        +"<br/>Num == 35 : " + (num2.getNum()==35)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 3 : " + (tps2.getUndoSize()==3));
      unitTests.innerHTML += testAdd3.innerHTML+"<br/>";


      tps2 = new jsTPS();
      num2 = new Num();
      let testAndMask0 = document.createElement("p");
      testAndMask0.innerHTML = "<br/><strong>testAndMask</strong>"
        +"<br/>Num == 0 : " + (num2.getNum()==0);
      unitTests.innerHTML += testAndMask0.innerHTML+"<br/>";

      let testAndMask1 = document.createElement("p");      
      tps2.addTransaction(new AddToNum_Transaction(num2,12));
      tps2.addTransaction(new AndMask_Transaction(num2, num2.getNum(), 4));
      testAndMask1.innerHTML = ("<br>AND MASK NUM 12 BY 4"
        +"<br/>Num == 4 : " + (num2.getNum()==4)
        +"<br/>jsTPS size == 2 : " + (tps2.getSize()==2));
      tps2.undoTransaction();
      testAndMask1.innerHTML += "<br/>UNDO TRANSACTION"
        +"<br/>Num == 12 : " + (num2.getNum()==12)
        +"<br/>jsTPS size == 2 : " + (tps2.getSize()==2)
        +"<br/>Redo size == 1 : " + (tps2.getRedoSize()==1)
        +"<br/>Undo size == 1 : " + (tps2.getUndoSize()==1);
      unitTests.innerHTML += testAndMask1.innerHTML+"<br/>";


      tps2 = new jsTPS();
      num2 = new Num();
      let testOrMask0 = document.createElement("p");
      testOrMask0.innerHTML = "<br/><strong>testOrMask</strong>"
        +"<br/>Num == 0 : " + (num2.getNum()==0);
      unitTests.innerHTML += testOrMask0.innerHTML+"<br/>";

      let testOrMask1 = document.createElement("p");
      tps2.addTransaction(new AddToNum_Transaction(num2,11));
      tps2.addTransaction(new OrMask_Transaction(num2, num2.getNum(), 4));
      testOrMask1.innerHTML = ("<br>OR MASK NUM 11 BY 4"
        +"<br/>Num == 15 : " + (num2.getNum()==15)
        +"<br/>jsTPS size == 2 : " + (tps2.getSize()==2));
      tps2.undoTransaction();
      testOrMask1.innerHTML += "<br/>UNDO TRANSACTION"
        +"<br/>Num == 11 : " + (num2.getNum()==11)
        +"<br/>jsTPS size == 2 : " + (tps2.getSize()==2)
        +"<br/>Redo size == 1 : " + (tps2.getRedoSize()==1)
        +"<br/>Undo size == 1 : " + (tps2.getUndoSize()==1);
      unitTests.innerHTML += testOrMask1.innerHTML+"<br/>";


      tps2 = new jsTPS();
      num2 = new Num();
      let testUndo0 = document.createElement("p");
      testUndo0.innerHTML = "<br/><strong>testUndo</strong>"
        +"<br/>Num == 0 : " + (num2.getNum()==0)
        +"<br/>jsTPS has transaction to Undo == false : " + (tps2.hasTransactionToUndo()==false)
        +"<br/>jsTPS has transaction to Redo == false : " + (tps2.hasTransactionToRedo()==false);
      // ADD 3 TRANSACTIONS (5, 10, and 20)
      tps2.addTransaction(new AddToNum_Transaction(num2, 5));
      tps2.addTransaction(new AddToNum_Transaction(num2, 10));
      tps2.addTransaction(new AddToNum_Transaction(num2, 20));
      testUndo0.innerHTML += ("<br>ADD 3 TRANSACTIONS (5, 10, 20)"
        +"<br/>jsTPS has transaction to Undo == true : " + (tps2.hasTransactionToUndo()==true)
        +"<br/>jsTPS has transaction to Redo == false : " + (tps2.hasTransactionToRedo()==false)
        +"<br/>Num == 35 : " + (num2.getNum()==35)
        +"<br/>jsTPS has transaction to Undo == true : " + (tps2.hasTransactionToUndo()==true)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 3 : " + (tps2.getUndoSize()==3));
      unitTests.innerHTML += testUndo0.innerHTML+"<br/>";

      tps2.undoTransaction();
      let testUndo1 = document.createElement("p");
      testUndo1.innerHTML = ("<br>UNDO TRANSACTION"
        +"<br/>jsTPS has transaction to Undo == true : " + (tps2.hasTransactionToUndo()==true)
        +"<br/>jsTPS has transaction to Redo == true : " + (tps2.hasTransactionToRedo()==true)
        +"<br/>Num == 15 : " + (num2.getNum()==15)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 1 : " + (tps2.getRedoSize()==1)
        +"<br/>Undo size == 2 : " + (tps2.getUndoSize()==2));
      unitTests.innerHTML += testUndo1.innerHTML+"<br/>";

      tps2.undoTransaction();
      let testUndo2 = document.createElement("p");
      testUndo2.innerHTML = ("<br>UNDO ANOTHER TRANSACTION"
        +"<br/>jsTPS has transaction to Undo == true : " + (tps2.hasTransactionToUndo()==true)
        +"<br/>jsTPS has transaction to Redo == true : " + (tps2.hasTransactionToRedo()==true)
        +"<br/>Num == 5 : " + (num2.getNum()==5)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 2 : " + (tps2.getRedoSize()==2)
        +"<br/>Undo size == 1 : " + (tps2.getUndoSize()==1));
      unitTests.innerHTML += testUndo2.innerHTML+"<br/>";

      tps2.undoTransaction();
      let testUndo3 = document.createElement("p");
      testUndo3.innerHTML = ("<br>UNDO ANOTHER TRANSACTION AGAIN"
        +"<br/>jsTPS has transaction to Undo == false : " + (tps2.hasTransactionToUndo()==false)
        +"<br/>jsTPS has transaction to Redo == true : " + (tps2.hasTransactionToRedo()==true)
        +"<br/>Num == 0 : " + (num2.getNum()==0)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 3 : " + (tps2.getRedoSize()==3)
        +"<br/>Undo size == 0 : " + (tps2.getUndoSize()==0));
      unitTests.innerHTML += testUndo3.innerHTML+"<br/>";

      tps2.undoTransaction();
      let testUndo4 = document.createElement("p");
      testUndo4.innerHTML = ("<br>UNDO TRANSACTION, NO MORE UNDO SO DOES NOTHING"
        +"<br/>jsTPS has transaction to Undo == false : " + (tps2.hasTransactionToUndo()==false)
        +"<br/>jsTPS has transaction to Redo == true : " + (tps2.hasTransactionToRedo()==true)
        +"<br/>Num == 0 : " + (num2.getNum()==0)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 3 : " + (tps2.getRedoSize()==3)
        +"<br/>Undo size == 0 : " + (tps2.getUndoSize()==0));
      unitTests.innerHTML += testUndo4.innerHTML+"<br/>";


      tps2 = new jsTPS();
      num2 = new Num();
      let testRedo0 = document.createElement("p");
      testRedo0.innerHTML = "<br/><strong>testRedo</strong>"
        +"<br/>Num == 0 : " + (num2.getNum()==0);      
      // ADD 3 TRANSACTIONS (5, 10, and 20)
      tps2.addTransaction(new AddToNum_Transaction(num2, 5));
      tps2.addTransaction(new AddToNum_Transaction(num2, 10));
      tps2.addTransaction(new AddToNum_Transaction(num2, 20));
      testRedo0.innerHTML += ("<br>ADD 3 TRANSACTIONS (5, 10, 20)"
        +"<br/>jsTPS has transaction to Undo == true : " + (tps2.hasTransactionToUndo()==true)
        +"<br/>jsTPS has transaction to Redo == false : " + (tps2.hasTransactionToRedo()==false)
        +"<br/>Num == 35 : " + (num2.getNum()==35)
        +"<br/>jsTPS has transaction to Undo == true : " + (tps2.hasTransactionToUndo()==true)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 3 : " + (tps2.getUndoSize()==3));
      unitTests.innerHTML += testRedo0.innerHTML+"<br/>";

      tps2.undoTransaction();
      tps2.doTransaction();
      let testRedo1 = document.createElement("p");
      testRedo1.innerHTML = ("<br>UNDO AND THEN REDO TRANSACTION"
        +"<br/>jsTPS has transaction to Undo == true : " + (tps2.hasTransactionToUndo()==true)
        +"<br/>jsTPS has transaction to Redo == false : " + (tps2.hasTransactionToRedo()==false)
        +"<br/>Num == 35 : " + (num2.getNum()==35)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 3 : " + (tps2.getUndoSize()==3));
      unitTests.innerHTML += testRedo1.innerHTML+"<br/>";

      tps2.undoTransaction();
      tps2.undoTransaction();
      tps2.doTransaction();
      tps2.doTransaction();
      let testRedo2 = document.createElement("p");
      testRedo2.innerHTML = ("<br>UNDO 2 TRANSACTIONS AND REDO THEM"
        +"<br/>jsTPS has transaction to Undo == true : " + (tps2.hasTransactionToUndo()==true)
        +"<br/>jsTPS has transaction to Redo == false : " + (tps2.hasTransactionToRedo()==false)
        +"<br/>Num == 35 : " + (num2.getNum()==35)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 3 : " + (tps2.getUndoSize()==3));
      unitTests.innerHTML += testRedo2.innerHTML+"<br/>";

      tps2.undoTransaction();
      tps2.undoTransaction();
      tps2.undoTransaction();
      tps2.doTransaction();
      tps2.doTransaction();
      tps2.doTransaction();
      let testRedo3 = document.createElement("p");
      testRedo3.innerHTML += ("<br>UNDO ALL 3 TRANSACTIONS AND REDO THEM"
        +"<br/>jsTPS has transaction to Undo == true : " + (tps2.hasTransactionToUndo()==true)
        +"<br/>jsTPS has transaction to Redo == false : " + (tps2.hasTransactionToRedo()==false)
        +"<br/>Num == 35 : " + (num2.getNum()==35)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 3 : " + (tps2.getUndoSize()==3));
      unitTests.innerHTML += testRedo3.innerHTML+"<br/>";

      tps2.undoTransaction();
      tps2.undoTransaction();
      tps2.undoTransaction();
      tps2.doTransaction();
      tps2.doTransaction();
      let testRedo4 = document.createElement("p");
      testRedo4.innerHTML = ("<br>UNDO 3 TRANSACTIONS AND REDO 2"
        +"<br/>jsTPS has transaction to Undo == true : " + (tps2.hasTransactionToUndo()==true)
        +"<br/>jsTPS has transaction to Redo == true : " + (tps2.hasTransactionToRedo()==true)
        +"<br/>Num == 15 : " + (num2.getNum()==15)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 1 : " + (tps2.getRedoSize()==1)
        +"<br/>Undo size == 2 : " + (tps2.getUndoSize()==2));
      unitTests.innerHTML += testRedo4.innerHTML+"<br/>";

      tps2.undoTransaction();
      tps2.undoTransaction();
      tps2.undoTransaction();
      tps2.doTransaction();
      tps2.doTransaction();
      tps2.doTransaction();
      tps2.doTransaction();
      let testRedo5 = document.createElement("p");
      testRedo5.innerHTML = ("<br>UNDO ALL 3 TRANSACTIONS AND REDO 4, LAST REDO DOES NOTHING"
        +"<br/>jsTPS has transaction to Undo == true : " + (tps2.hasTransactionToUndo()==true)
        +"<br/>jsTPS has transaction to Redo == false : " + (tps2.hasTransactionToRedo()==false)
        +"<br/>Num == 35 : " + (num2.getNum()==35)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 3 : " + (tps2.getUndoSize()==3));
      unitTests.innerHTML += testRedo5.innerHTML+"<br/>";

      
      tps2 = new jsTPS();
      num2 = new Num();
      let testClear0 = document.createElement("p");
      testClear0.innerHTML = "<br/><strong>testClear</strong>"
        +"<br/>Num == 0 : " + (num2.getNum()==0);      
      // ADD 3 TRANSACTIONS (5, 10, and 20)
      tps2.addTransaction(new AddToNum_Transaction(num2, 5));
      tps2.addTransaction(new AddToNum_Transaction(num2, 10));
      tps2.addTransaction(new AddToNum_Transaction(num2, 20));
      testClear0.innerHTML += ("<br>ADD 3 TRANSACTIONS (5, 10, 20)"
        +"<br/>Num == 35 : " + (num2.getNum()==35)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 3 : " + (tps2.getUndoSize()==3));
      unitTests.innerHTML += testClear0.innerHTML+"<br/>";

      // CLEAR ALL THE TRANSACTIONS
      tps2.clearAllTransactions();
      let testClear1 = document.createElement("p");
      testClear1.innerHTML = ("<br>CLEAR ALL TRANSACTIONS"
        +"<br/>Num == 35 : " + (num2.getNum()==35)
        +"<br/>jsTPS size == 0 : " + (tps2.getSize()==0)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 0 : " + (tps2.getUndoSize()==0));
      unitTests.innerHTML += testClear1.innerHTML+"<br/>";
      
      let testClear2 = document.createElement("p");     
      // ADD 3 TRANSACTIONS (5, 10, and 20)
      tps2.addTransaction(new AddToNum_Transaction(num2, 5));
      tps2.addTransaction(new AddToNum_Transaction(num2, 10));
      tps2.addTransaction(new AddToNum_Transaction(num2, 20));
      testClear2.innerHTML += ("<br>ADD 3 TRANSACTIONS (5, 10, 20)"
        +"<br/>Num == 70 : " + (num2.getNum()==70)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 3 : " + (tps2.getUndoSize()==3));
      unitTests.innerHTML += testClear2.innerHTML+"<br/>";

      tps2.clearAllTransactions();
      let testClear3 = document.createElement("p");
      testClear3.innerHTML = ("<br>CLEAR ALL TRANSACTIONS AGAIN"
        +"<br/>Num == 70 : " + (num2.getNum()==70)
        +"<br/>jsTPS size == 0 : " + (tps2.getSize()==0)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 0 : " + (tps2.getUndoSize()==0));
      unitTests.innerHTML += testClear3.innerHTML+"<br/>";

      let testClear4 = document.createElement("p");     
      // ADD 3 TRANSACTIONS (5, 10, and 20)
      tps2.addTransaction(new AddToNum_Transaction(num2, 5));
      tps2.addTransaction(new AddToNum_Transaction(num2, 10));
      tps2.addTransaction(new AddToNum_Transaction(num2, 20));
      testClear4.innerHTML += ("<br>ADD 3 TRANSACTIONS (5, 10, 20)"
        +"<br/>Num == 105 : " + (num2.getNum()==105)
        +"<br/>jsTPS size == 3 : " + (tps2.getSize()==3)
        +"<br/>Redo size == 0 : " + (tps2.getRedoSize()==0)
        +"<br/>Undo size == 3 : " + (tps2.getUndoSize()==3));
      unitTests.innerHTML += testClear4.innerHTML+"<br/>";

    </script>

  </body>
</html>